{"version":3,"file":"src_app_page_login_login_module_ts.js","mappings":"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","sources":["./src/app/page/login/login-routing.module.ts","./src/app/page/login/login.module.ts","./src/app/page/login/login.page.ts","./src/app/page/login/login.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  },\r\n  { path: 'login', component: LoginPage }, // Ruta para la página de login\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPageRoutingModule } from './login-routing.module';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    LoginPageRoutingModule\r\n  ],\r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { SupabaseService } from 'src/app/service/supabase/supabase.service';\r\nimport { AlertController } from '@ionic/angular';\r\nimport { AutenticacionService } from 'src/app/service/autenticacion/autenticacion.service';\r\nimport { environment } from 'src/environments/environment';\r\nimport { Preferences } from '@capacitor/preferences';\r\nimport * as CryptoJS from 'crypto-js';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage implements OnInit {\r\n  correo: string = \"\";\r\n  password: string = \"\";\r\n  passwordVisible: boolean = false;  // Nueva variable para controlar visibilidad\r\n\r\n  constructor(\r\n    private supabaseService: SupabaseService,\r\n    private router: Router,\r\n    private alertController: AlertController,\r\n    private _authService: AutenticacionService\r\n  ) { }\r\n\r\n  ngOnInit() { }\r\n\r\n    // Método para alternar la visibilidad de la contraseña\r\n    togglePasswordVisibility() {\r\n      this.passwordVisible = !this.passwordVisible;\r\n    }\r\n\r\n  resetForm() {\r\n    this.correo = '';\r\n    this.password = '';\r\n  }\r\n\r\n  login(correo: string, password: string) {\r\n    this.supabaseService.getUsuarioByCorreo(correo).subscribe({\r\n      next: async (usuario) => {\r\n        if (usuario && usuario.length > 0) {\r\n          const usuarioData = usuario[0];\r\n          if (usuarioData && this.validatePassword(password, usuarioData.password)) { // Verificar la contraseña\r\n            console.info(\"Usuario Existe\");\r\n            const userData = { expiration: Date.now() + 20 * 60 * 1000 };\r\n            const encryptedData = CryptoJS.AES.encrypt(JSON.stringify(userData), environment.apiKeySupabase).toString();\r\n            await Preferences.set({\r\n              key: 'userData',\r\n              value: encryptedData,\r\n            });\r\n            this._authService.setAutenticado(true, usuarioData.rut);\r\n            this.resetForm();\r\n            this.router.navigate(['home'], {\r\n              state: { usuario: correo }\r\n            });\r\n          } else {\r\n            console.error(\"Contraseña incorrecta\");\r\n            await this.presentAlert('Error', 'Contraseña incorrecta');\r\n          }\r\n        } else {\r\n          console.error(\"Usuario No existe\");\r\n          await this.presentAlert('Error', 'El usuario no existe');\r\n        }\r\n      },\r\n      error: async (error) => {\r\n        console.error(\"Error al iniciar sesión\", error);\r\n        await this.presentAlert('Error', 'Ocurrió un error al intentar iniciar sesión');\r\n      }\r\n    });\r\n  }\r\n\r\n  validatePassword(inputPassword: string, storedPassword: string): boolean {\r\n\r\n    return inputPassword === storedPassword;\r\n  }\r\n\r\n  irRegistro() {\r\n    this.resetForm();\r\n    this.router.navigate(['/registro']);\r\n  }\r\n\r\n  async presentAlert(header: string, message: string) {\r\n    const alert = await this.alertController.create({\r\n      header: header,\r\n      message: message,\r\n      buttons: ['OK']\r\n    });\r\n    await alert.present();\r\n  }\r\n}\r\n","<ion-header [translucent]=\"true\">\r\n  <ion-toolbar>\r\n    <ion-buttons slot=\"start\">\r\n      <ion-menu-button></ion-menu-button>\r\n    </ion-buttons>\r\n    <ion-title>FindCar</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content class=\"ion-padding\">\r\n\r\n  <ion-card>\r\n    <ion-card-header>\r\n      <h3>Iniciar Sesión</h3>\r\n    </ion-card-header>\r\n\r\n    <ion-card-content>\r\n      <ion-item>\r\n        <ion-label position=\"floating\">Correo</ion-label>\r\n        <ion-input type=\"text\" [(ngModel)]=\"correo\" required></ion-input>\r\n      </ion-item>\r\n\r\n      <ion-item>\r\n        <ion-label position=\"floating\">Password</ion-label>\r\n        <ion-input [type]=\"passwordVisible ? 'text' : 'password'\" [(ngModel)]=\"password\" required></ion-input>\r\n        <ion-button fill=\"clear\" slot=\"end\" (click)=\"togglePasswordVisibility()\">\r\n          <ion-icon [name]=\"passwordVisible ? 'eye-off' : 'eye'\"></ion-icon>\r\n        </ion-button>\r\n      </ion-item>\r\n      <ion-button expand=\"block\" type=\"submit\" (click)=\"login(correo, password)\">Login</ion-button>\r\n\r\n\r\n      <div class=\"login-footer\">\r\n        <ion-button fill=\"clear\" >Olvidaste tu contraseña?</ion-button>\r\n        <ion-button fill=\"clear\" (click)=\"irRegistro()\">Crear cuenta</ion-button>\r\n      </div>\r\n    </ion-card-content>\r\n  </ion-card>\r\n\r\n</ion-content>\r\n"],"names":["RouterModule","LoginPage","routes","path","component","LoginPageRoutingModule","forChild","imports","i1","exports","CommonModule","FormsModule","IonicModule","LoginPageModule","declarations","environment","Preferences","CryptoJS","constructor","supabaseService","router","alertController","_authService","correo","password","passwordVisible","ngOnInit","togglePasswordVisibility","resetForm","login","_this","getUsuarioByCorreo","subscribe","next","_ref","_asyncToGenerator","usuario","length","usuarioData","validatePassword","console","info","userData","expiration","Date","now","encryptedData","AES","encrypt","JSON","stringify","apiKeySupabase","toString","set","key","value","setAutenticado","rut","navigate","state","error","presentAlert","_x","apply","arguments","_ref2","_x2","inputPassword","storedPassword","irRegistro","header","message","_this2","alert","create","buttons","present","i0","ɵɵdirectiveInject","SupabaseService","i2","Router","i3","AlertController","i4","AutenticacionService","selectors","decls","vars","consts","template","LoginPage_Template","rf","ctx","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵtext","ɵɵtwoWayListener","LoginPage_Template_ion_input_ngModelChange_15_listener","$event","ɵɵtwoWayBindingSet","LoginPage_Template_ion_input_ngModelChange_19_listener","ɵɵlistener","LoginPage_Template_ion_button_click_20_listener","LoginPage_Template_ion_button_click_22_listener","LoginPage_Template_ion_button_click_27_listener","ɵɵproperty","ɵɵadvance","ɵɵtwoWayProperty"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}