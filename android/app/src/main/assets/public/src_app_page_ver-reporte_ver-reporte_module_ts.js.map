{"version":3,"file":"src_app_page_ver-reporte_ver-reporte_module_ts.js","mappings":"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","sources":["./src/app/page/ver-reporte/ver-reporte-routing.module.ts","./src/app/page/ver-reporte/ver-reporte.module.ts","./src/app/page/ver-reporte/ver-reporte.page.ts","./src/app/page/ver-reporte/ver-reporte.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { VerReportePage } from './ver-reporte.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: VerReportePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class VerReportePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { VerReportePageRoutingModule } from './ver-reporte-routing.module';\r\n\r\nimport { VerReportePage } from './ver-reporte.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    VerReportePageRoutingModule\r\n  ],\r\n  declarations: [VerReportePage]\r\n})\r\nexport class VerReportePageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { SupabaseService } from '../../service/supabase/supabase.service';\r\nimport { AutenticacionService } from '../../service/autenticacion/autenticacion.service';\r\nimport { Router } from '@angular/router';\r\nimport { HttpResponse } from '@angular/common/http';\r\nimport { AlertController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-ver-reporte',\r\n  templateUrl: './ver-reporte.page.html',\r\n  styleUrls: ['./ver-reporte.page.scss'],\r\n})\r\nexport class VerReportePage implements OnInit {\r\n  reportes: any[] = [];\r\n  rutUsuario: string | null = null;\r\n\r\n  constructor(\r\n    private supabaseService: SupabaseService,\r\n    private autenticacionService: AutenticacionService,\r\n    private router: Router,\r\n    private alertController: AlertController\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    // Obtener el RUT del usuario autenticado y luego cargar los reportes\r\n    this.autenticacionService.obtenerRutUsuario().subscribe(rut => {\r\n      this.rutUsuario = rut;\r\n      if (this.rutUsuario) {\r\n        this.cargarReportes(); // Cargar reportes solo si el usuario está autenticado\r\n      }\r\n    });\r\n\r\n    // Suscribirse a los cambios de reportes\r\n    this.supabaseService.reportes$.subscribe(reportes => {\r\n      this.reportes = reportes.filter(reporte => reporte.rut_usuario === this.rutUsuario); // Filtrar por RUT de usuario\r\n    });\r\n  }\r\n\r\n  cargarReportes() {\r\n    if (this.rutUsuario) {\r\n      this.supabaseService.getReportesByUsuario(this.rutUsuario).subscribe({\r\n        next: (response: HttpResponse<any>) => {\r\n          this.reportes = response.body; // Extraer el cuerpo de la respuesta\r\n        },\r\n        error: (err) => {\r\n          console.error('Error al cargar reportes:', err);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  navegarAEditarReporte(id_reporte: number) {\r\n    this.router.navigate(['/editar-reporte', id_reporte]);\r\n  }\r\n\r\n  async eliminarReporte(id_reporte: number) {\r\n    const alert = await this.alertController.create({\r\n      header: 'Confirmar Eliminación',\r\n      message: '¿Estás seguro de que deseas eliminar este reporte?',\r\n      buttons: [\r\n        {\r\n          text: 'Cancelar',\r\n          role: 'cancel',\r\n          cssClass: 'secondary',\r\n        },\r\n        {\r\n          text: 'Eliminar',\r\n          handler: () => {\r\n            this.supabaseService.deleteReporte(id_reporte).subscribe({\r\n              next: async (response) => {\r\n                console.log('Reporte eliminado:', response);\r\n\r\n                // Mostrar mensaje de éxito\r\n                const successAlert = await this.alertController.create({\r\n                  header: 'Éxito',\r\n                  message: 'El reporte ha sido eliminado con éxito.',\r\n                  buttons: ['OK']\r\n                });\r\n                await successAlert.present();\r\n\r\n                // Redirigir después de la eliminación\r\n                this.router.navigate(['ver-reporte']);\r\n              },\r\n              error: (err) => {\r\n                console.error('Error al eliminar el reporte:', err);\r\n              }\r\n            });\r\n          }\r\n        }\r\n      ]\r\n    });\r\n\r\n    await alert.present();\r\n  }\r\n\r\n  doRefresh(event: any) {\r\n    console.log('Actualizando reportes...');\r\n\r\n    // Muestra el cargador mientras se actualizan los reportes\r\n    this.cargarReportes();\r\n\r\n    // Finalizar el refresher\r\n    event.target.complete();\r\n  }\r\n}\r\n","<ion-header [translucent]=\"true\">\r\n  <ion-toolbar>\r\n    <ion-buttons slot=\"start\">\r\n      <ion-menu-button></ion-menu-button>\r\n    </ion-buttons>\r\n    <ion-title>Mis reportes</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-refresher slot=\"fixed\" (ionRefresh)=\"doRefresh($event)\">\r\n    <ion-refresher-content\r\n\r\n      refreshingSpinner=\"bubbles\">\r\n    </ion-refresher-content>\r\n  </ion-refresher>\r\n  <div class=\"container-1\" *ngIf=\"!reportes.length\" class=\"empty-state\">\r\n    <h1>No hay reportes creados</h1>\r\n  </div>\r\n  <div class=\"container-1\" *ngFor=\"let reporte of reportes\">\r\n    <h4>Publicado el {{reporte.fecha_publicacion}}</h4>\r\n    <img *ngIf=\"reporte.foto\" [src]=\"reporte.foto\" alt=\"Foto del reporte\" class=\"responsive-img\">\r\n\r\n    <ion-list class=\"home\">\r\n      <ion-item>\r\n        <ion-label>\r\n          <p>Región: {{ reporte.region?.nombre }}</p>\r\n          <p>Tipo de Vehículo: {{ reporte.tipo_vehiculo?.tipo }}</p>\r\n          <p>Marca: {{ reporte.marca?.marca }}</p>\r\n          <p>Modelo: {{ reporte.modelo }}</p>\r\n          <p>Color: {{ reporte.color }}</p>\r\n          <p>Patente: {{ reporte.patente }}</p>\r\n        </ion-label>\r\n        <ion-button [routerLink]=\"['/editar-reporte', reporte.id_reporte]\">Editar</ion-button>\r\n        <ion-button color=\"danger\" (click)=\"eliminarReporte(reporte.id_reporte)\">Eliminar</ion-button>\r\n\r\n      </ion-item>\r\n    </ion-list>\r\n  </div>\r\n</ion-content>\r\n"],"names":["RouterModule","VerReportePage","routes","path","component","VerReportePageRoutingModule","forChild","imports","i1","exports","CommonModule","FormsModule","IonicModule","VerReportePageModule","declarations","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵɵproperty","reporte_r2","foto","ɵɵsanitizeUrl","ɵɵtemplate","VerReportePage_div_10_img_3_Template","ɵɵlistener","VerReportePage_div_10_Template_ion_button_click_21_listener","ɵɵrestoreView","_r1","$implicit","ctx_r2","ɵɵnextContext","ɵɵresetView","eliminarReporte","id_reporte","ɵɵadvance","ɵɵtextInterpolate1","fecha_publicacion","region","nombre","tipo_vehiculo","tipo","marca","modelo","color","patente","ɵɵpureFunction1","_c0","constructor","supabaseService","autenticacionService","router","alertController","reportes","rutUsuario","ngOnInit","obtenerRutUsuario","subscribe","rut","cargarReportes","reportes$","filter","reporte","rut_usuario","getReportesByUsuario","next","response","body","error","err","console","navegarAEditarReporte","navigate","_this","_asyncToGenerator","alert","create","header","message","buttons","text","role","cssClass","handler","deleteReporte","_ref","log","successAlert","present","_x","apply","arguments","doRefresh","event","target","complete","ɵɵdirectiveInject","SupabaseService","i2","AutenticacionService","i3","Router","i4","AlertController","selectors","decls","vars","consts","template","VerReportePage_Template","rf","ctx","VerReportePage_Template_ion_refresher_ionRefresh_7_listener","$event","VerReportePage_div_9_Template","VerReportePage_div_10_Template","length"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}